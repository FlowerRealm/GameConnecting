# 房间服务 (`roomService.js`)

该文件提供了用于管理房间（也称为服务器）的核心业务逻辑。它处理房间的创建、删除、成员管理以及为管理员提供的高级功能。

## 函数

---

### 1. `createRoom(name, description, room_type, creatorId)`

- **描述**: 创建一个新房间，并将创建者自动添加为该房间的所有者。
- **参数**:
    - `name`: 房间的名称。
    - `description` (可选): 房间的描述。
    - `room_type` (可选): 房间类型 (`public` 或 `private`)，默认为 `public`。
    - `creatorId`: 创建房间的用户的 ID。
- **返回**: 一个包含新创建的房间数据的结果对象。

---

### 2. `listPublicRooms()`

- **描述**: 获取所有公开房间的列表。
- **返回**: 一个包含公开房间列表的结果对象。

---

### 3. `joinRoom(roomId, userId)`

- **描述**: 允许用户加入一个公共房间。对于私有房间，当前实现会拒绝加入请求。
- **参数**:
    - `roomId`: 要加入的房间的 ID。
    - `userId`: 用户的 ID。
- **返回**: 一个包含新成员关系数据的结果对象。

---

### 4. `leaveRoom(roomId, userId)`

- **描述**: 允许用户离开一个他们是成员的房间。房间所有者不能离开，必须删除房间。
- **参数**:
    - `roomId`: 要离开的房间的 ID。
    - `userId`: 用户的 ID。
- **返回**: 一个表示操作成功的消息对象。

---

### 5. `getRoomMembers(roomId)`

- **描述**: 获取特定房间的所有成员及其基本信息（用户名、状态）。
- **参数**:
    - `roomId`: 房间的 ID。
- **返回**: 一个包含格式化后的成员列表的结果对象。

---

### 6. `deleteRoom(roomId, userId)`

- **描述**: 删除一个房间。只有房间的创建者才能执行此操作。
- **参数**:
    - `roomId`: 要删除的房间的 ID。
    - `userId`: 尝试删除房间的用户的 ID。
- **返回**: 一个表示操作成功的消息对象。

---

### 7. `getAllServersForAdmin(queryParams)`

- **描述**: 为管理员获取所有服务器的分页列表，并附带额外信息，如创建者用户名和成员数量。
- **参数**:
    - `queryParams` (可选): 包含 `page` 和 `limit` 的对象，用于分页。
- **返回**: 一个包含增强后的服务器列表、总数和分页信息的结果对象。

---

### 8. `updateServerByAdmin(roomId, updates)`

- **描述**: 允许管理员更新服务器的详细信息，如名称和描述。
- **参数**:
    - `roomId`: 要更新的服务器的 ID。
    - `updates`: 包含要更新的字段的对象。
- **返回**: 一个包含更新后的服务器数据的结果对象。

---

### 9. `deleteServerByAdmin(roomId)`

- **描述**: 允许管理员删除任何服务器，无论其所有者是谁。
- **参数**:
    - `roomId`: 要删除的服务器的 ID。
- **返回**: 一个表示操作成功的消息对象。

---

### 10. `kickMemberByAdmin(roomId, userIdToKick)`

- **描述**: 允许管理员从服务器中踢出一个成员。不能踢出房间所有者。
- **参数**:
    - `roomId`: 服务器的 ID。
    - `userIdToKick`: 要踢出的用户的 ID。
- **返回**: 一个表示操作成功的消息对象。
