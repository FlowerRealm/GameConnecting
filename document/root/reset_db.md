# 数据库重置脚本 (`reset_db.sh`)

该 Bash 脚本用于在本地开发环境中重置 PostgreSQL 数据库。它会永久删除指定的数据库，然后重新创建它，并应用所有数据库迁移。**此脚本会清除所有数据，请谨慎使用。**

## 功能

-   **数据清除**: 永久删除 `APP_DB_NAME` 指定的数据库。
-   **数据库重建**: 重新创建同名数据库，并将其所有者设置为 `APP_DB_USER`。
-   **应用迁移**: 导航到 `backend` 目录并运行 `npm run db:migrate:up` 命令，以应用所有数据库迁移，从而重建数据库模式。

## 配置

在运行脚本之前，您可能需要根据您的本地 PostgreSQL 设置修改以下变量：

-   `APP_DB_NAME`: 应用程序使用的数据库名称（默认为 `gameconnecting`）。
-   `APP_DB_USER`: 应用程序连接数据库时使用的用户（默认为 `gameconnecting`）。
-   `ADMIN_DB_USER`: 具有删除和创建数据库权限的 PostgreSQL 管理员用户（默认为 `postgres`）。
-   `ADMIN_DB_PASS`: `ADMIN_DB_USER` 的密码。**请务必替换为您的实际密码。**
-   `DB_HOST`: 数据库主机（默认为 `localhost`）。
-   `DB_PORT`: 数据库端口（默认为 `5432`）。

## 用法

在项目根目录下执行此脚本：

```bash
./reset_db.sh
```

脚本会提示您确认操作，以防止意外数据丢失。

## 注意事项

-   **数据丢失**: 运行此脚本将永久删除 `APP_DB_NAME` 指定的数据库中的所有数据。请确保您了解此操作的后果。
-   **权限**: 运行脚本的用户必须具有执行 `psql` 命令的权限，并且 `ADMIN_DB_USER` 必须具有删除和创建数据库的权限。
-   **密码安全**: 脚本中硬编码 `ADMIN_DB_PASS` 是不安全的做法，仅适用于受控的开发环境。在生产环境或共享环境中，应使用更安全的密码管理方式（例如，通过环境变量或密码管理器）。
-   **依赖**: 脚本依赖于 `psql` 命令行工具和 `backend` 目录中的 `npm run db:migrate:up` 命令。
