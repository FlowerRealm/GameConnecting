# 前端登录脚本 (`login.js`)

该文件是前端登录页面的核心 JavaScript 逻辑，负责处理用户登录请求、验证输入数据，并根据登录结果和用户角色进行页面重定向。

## 依赖

-   `./auth.js`: `AuthManager` 实例，用于处理用户登录逻辑和获取用户角色。
-   `./navbar.js`: `initNavbar` 函数，用于初始化导航栏。

## 主要功能

### 1. 自动重定向

-   页面加载时，如果用户已经通过 `AuthManager.isAuthenticated()` 认证，则根据用户的角色（管理员或普通用户）直接重定向到相应的页面（`/administrator/user` 或 `/`）。

### 2. 导航栏初始化

-   调用 `initNavbar()` 初始化页面导航栏。

### 3. 登录表单处理

-   **表单元素**: 获取 `login-form` 和 `error` 消息显示元素。
-   **事件监听**: 监听表单的 `submit` 事件。
-   **逻辑**:
    1.  阻止表单的默认提交行为。
    2.  获取用户输入的用户名 (`username`) 和密码 (`password`)。
    3.  清空并隐藏之前的错误消息。
    4.  **客户端验证**: 检查用户名和密码是否为空。如果为空，则显示相应的错误消息并返回。
    5.  **调用登录服务**: 调用 `auth.login(username, password)` 向后端发送登录请求。
    6.  **处理登录结果**:
        -   如果 `result.success` 为 `true`，则显示“登录成功，正在跳转...”的消息，并在 1 秒后根据用户角色重定向到 `/administrator/user` (管理员) 或 `/` (普通用户)。
        -   如果 `result.success` 为 `false`，则显示后端返回的错误消息或通用错误消息。
        -   捕获网络错误或其他异常，显示“网络错误，请稍后重试”的消息。

## 交互流程

1.  用户访问登录页面。
2.  如果用户已登录，则自动重定向。
3.  用户输入用户名和密码，点击“登录”按钮。
4.  前端进行基本验证。
5.  向后端发送登录请求。
6.  根据后端响应，显示成功/失败消息，并进行页面跳转。

## 维护

该文档应与 `frontend/public/js/login.js` 文件的任何更改保持同步，以确保其准确性和实用性。
