# 前端导航栏脚本 (`navbar.js`)

该文件定义了 `initNavbar` 函数，负责根据用户的认证状态和角色动态渲染导航栏内容。它确保了用户在登录/注销或角色变化时，导航栏能够正确显示相应的链接和操作。

## 依赖

-   `./auth.js`: `AuthManager` 实例，用于检查用户认证状态、获取用户名和角色。

## 主要功能

### 1. `initNavbar()` 函数

-   **描述**: 初始化导航栏的显示内容。
-   **逻辑**:
    1.  获取导航栏的 DOM 元素，并为其添加 `glassmorphic-container` 类（如果尚未添加）。
    2.  检查用户是否已通过 `auth.isAuthenticated()` 认证。
    3.  **如果用户已认证**:
        -   根据 `auth.getRole()` 获取的用户角色（`admin` 或其他），动态生成 `navMenu` 的内容。
            -   **管理员**: 显示“服务器管理”和“用户管理”链接。
            -   **普通用户**: 显示“服务器”和“所有用户”链接。
        -   动态生成 `authButtons` 的内容，包括用户头像（显示用户名首字母）和下拉菜单（包含“个人资料”和“退出登录”）。
        -   为“退出登录”按钮添加事件监听器，点击后调用 `auth.logout()` 并重定向到主页。
    4.  **如果用户未认证**:
        -   清空 `navMenu` 的内容。
        -   显示“登录”和“注册”按钮。
    5.  根据当前页面的 URL 路径，为导航栏中的当前活动链接添加 `active` 类，以高亮显示。

### 2. `toggleDropdown()` 函数

-   **描述**: 这是一个全局函数，用于切换用户头像下拉菜单的显示/隐藏状态。
-   **用法**: 通常通过 HTML 元素的 `onclick` 属性调用。

### 3. 全局点击事件监听器

-   监听 `document` 上的 `click` 事件，如果点击发生在用户头像下拉菜单之外，则关闭所有打开的下拉菜单。

## 交互流程

-   页面加载时，`initNavbar()` 被调用，根据用户的登录状态和角色渲染导航栏。
-   登录用户点击用户头像，下拉菜单显示；再次点击或点击菜单外部，菜单隐藏。
-   点击“退出登录”按钮，用户会话被清除，并重定向到主页。

## 维护

该文档应与 `frontend/public/js/navbar.js` 文件的任何更改保持同步，以确保其准确性和实用性。
